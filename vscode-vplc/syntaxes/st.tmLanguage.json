{
  "$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
  "name": "Structured Text",
  "scopeName": "source.st",
  "patterns": [
    { "include": "#comments" },
    { "include": "#strings" },
    { "include": "#numbers" },
    { "include": "#time-literals" },
    { "include": "#keywords-control" },
    { "include": "#keywords-declaration" },
    { "include": "#keywords-types" },
    { "include": "#keywords-operators" },
    { "include": "#constants" },
    { "include": "#functions" },
    { "include": "#variables" }
  ],
  "repository": {
    "comments": {
      "patterns": [
        {
          "name": "comment.line.double-slash.st",
          "match": "//.*$"
        },
        {
          "name": "comment.block.st",
          "begin": "\\(\\*",
          "end": "\\*\\)",
          "patterns": [
            {
              "include": "#comments"
            }
          ]
        }
      ]
    },
    "strings": {
      "patterns": [
        {
          "name": "string.quoted.single.st",
          "begin": "'",
          "end": "'",
          "patterns": [
            {
              "name": "constant.character.escape.st",
              "match": "\\$[LNPRTlnprt$']|\\$[0-9A-Fa-f]{2}"
            }
          ]
        },
        {
          "name": "string.quoted.double.st",
          "begin": "\"",
          "end": "\"",
          "patterns": [
            {
              "name": "constant.character.escape.st",
              "match": "\\$[LNPRTlnprt$\"]|\\$[0-9A-Fa-f]{2}"
            }
          ]
        }
      ]
    },
    "numbers": {
      "patterns": [
        {
          "name": "constant.numeric.hex.st",
          "match": "\\b16#[0-9A-Fa-f_]+\\b"
        },
        {
          "name": "constant.numeric.octal.st",
          "match": "\\b8#[0-7_]+\\b"
        },
        {
          "name": "constant.numeric.binary.st",
          "match": "\\b2#[01_]+\\b"
        },
        {
          "name": "constant.numeric.float.st",
          "match": "\\b[0-9]+\\.[0-9]+([Ee][+-]?[0-9]+)?\\b"
        },
        {
          "name": "constant.numeric.integer.st",
          "match": "\\b[0-9][0-9_]*\\b"
        }
      ]
    },
    "time-literals": {
      "patterns": [
        {
          "name": "constant.other.time.st",
          "match": "\\b[Tt](?:[Ii][Mm][Ee])?#-?(?:[0-9]+[Dd])?(?:[0-9]+[Hh])?(?:[0-9]+[Mm])?(?:[0-9]+[Ss])?(?:[0-9]+[Mm][Ss])?\\b"
        },
        {
          "name": "constant.other.date.st",
          "match": "\\b[Dd](?:[Aa][Tt][Ee])?#[0-9]{4}-[0-9]{2}-[0-9]{2}\\b"
        },
        {
          "name": "constant.other.datetime.st",
          "match": "\\b[Dd][Tt]#[0-9]{4}-[0-9]{2}-[0-9]{2}-[0-9]{2}:[0-9]{2}:[0-9]{2}\\b"
        },
        {
          "name": "constant.other.tod.st",
          "match": "\\b[Tt][Oo][Dd]#[0-9]{2}:[0-9]{2}:[0-9]{2}(?:\\.[0-9]+)?\\b"
        }
      ]
    },
    "keywords-control": {
      "patterns": [
        {
          "name": "keyword.control.st",
          "match": "\\b(?i:IF|THEN|ELSIF|ELSE|END_IF|CASE|OF|END_CASE|FOR|TO|BY|DO|END_FOR|WHILE|END_WHILE|REPEAT|UNTIL|END_REPEAT|EXIT|CONTINUE|RETURN)\\b"
        }
      ]
    },
    "keywords-declaration": {
      "patterns": [
        {
          "name": "keyword.declaration.st",
          "match": "\\b(?i:PROGRAM|END_PROGRAM|FUNCTION|END_FUNCTION|FUNCTION_BLOCK|END_FUNCTION_BLOCK|VAR|VAR_INPUT|VAR_OUTPUT|VAR_IN_OUT|VAR_GLOBAL|VAR_EXTERNAL|VAR_TEMP|END_VAR|CONSTANT|RETAIN|AT|TYPE|END_TYPE|STRUCT|END_STRUCT|ARRAY)\\b"
        }
      ]
    },
    "keywords-types": {
      "patterns": [
        {
          "name": "storage.type.st",
          "match": "\\b(?i:BOOL|BYTE|WORD|DWORD|LWORD|SINT|INT|DINT|LINT|USINT|UINT|UDINT|ULINT|REAL|LREAL|TIME|DATE|TIME_OF_DAY|TOD|DATE_AND_TIME|DT|STRING|WSTRING)\\b"
        }
      ]
    },
    "keywords-operators": {
      "patterns": [
        {
          "name": "keyword.operator.logical.st",
          "match": "\\b(?i:AND|OR|XOR|NOT)\\b"
        },
        {
          "name": "keyword.operator.comparison.st",
          "match": ":=|<>|<=|>=|<|>|="
        },
        {
          "name": "keyword.operator.arithmetic.st",
          "match": "\\b(?i:MOD)\\b|\\+|\\-|\\*|/|\\*\\*"
        }
      ]
    },
    "constants": {
      "patterns": [
        {
          "name": "constant.language.boolean.st",
          "match": "\\b(?i:TRUE|FALSE)\\b"
        }
      ]
    },
    "functions": {
      "patterns": [
        {
          "name": "support.function.standard.st",
          "match": "\\b(?i:ABS|SQRT|LN|LOG|EXP|SIN|COS|TAN|ASIN|ACOS|ATAN|ATAN2|SHL|SHR|ROL|ROR|SEL|MUX|MAX|MIN|LIMIT|MOVE|ADD|SUB|MUL|DIV|GT|GE|EQ|LE|LT|NE)\\b"
        },
        {
          "name": "support.function.conversion.st",
          "match": "\\b(?i:BOOL_TO_|INT_TO_|REAL_TO_|TIME_TO_|DATE_TO_|STRING_TO_|TO_BOOL|TO_INT|TO_REAL|TO_TIME|TO_DATE|TO_STRING|TRUNC|TRUNC_INT)\\w*\\b"
        },
        {
          "name": "support.function.timer.st",
          "match": "\\b(?i:TON|TOF|TP|R_TRIG|F_TRIG|SR|RS|CTU|CTD|CTUD)\\b"
        }
      ]
    },
    "variables": {
      "patterns": [
        {
          "name": "variable.other.io.st",
          "match": "%[IQM][XBWDLxbwdl]?[0-9]+(\\.[0-9]+)?"
        },
        {
          "name": "variable.other.st",
          "match": "\\b[A-Za-z_][A-Za-z0-9_]*\\b"
        }
      ]
    }
  }
}
